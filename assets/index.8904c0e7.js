var pe=Object.defineProperty;var ve=(s,e,t)=>e in s?pe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var f=(s,e,t)=>(ve(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=t(o);fetch(o.href,n)}})();const u=8,O=["a","b","c","d","e","f","g","h"];var h=(s=>(s.PAWN="p",s.KNIGHT="n",s.BISHOP="b",s.ROOK="r",s.QUEEN="q",s.KING="k",s))(h||{}),r=(s=>(s.WHITE="w",s.BLACK="b",s))(r||{}),m=(s=>(s[s.None=0]="None",s[s.PossibleMove=1]="PossibleMove",s[s.Capture=2]="Capture",s[s.Check=3]="Check",s[s.Origin=4]="Origin",s[s.Castling=5]="Castling",s[s.Passant=6]="Passant",s))(m||{});const ke={p:{moveDirections:[{file:1,rank:0}],maxMove:1,firstMoveMax:2,specialAttack:[{file:1,rank:1},{file:1,rank:-1}]},n:{moveDirections:[{file:2,rank:1},{file:2,rank:-1},{file:-2,rank:1},{file:-2,rank:-1},{file:1,rank:2},{file:1,rank:-2},{file:-1,rank:2},{file:-1,rank:-2}],maxMove:1},b:{moveDirections:[{file:1,rank:1},{file:1,rank:-1},{file:-1,rank:1},{file:-1,rank:-1}],maxMove:8},r:{moveDirections:[{file:1,rank:0},{file:-1,rank:0},{file:0,rank:1},{file:0,rank:-1}],maxMove:8},q:{moveDirections:[{file:1,rank:0},{file:-1,rank:0},{file:0,rank:1},{file:0,rank:-1},{file:1,rank:1},{file:1,rank:-1},{file:-1,rank:1},{file:-1,rank:-1}],maxMove:8},k:{moveDirections:[{file:1,rank:0},{file:-1,rank:0},{file:0,rank:1},{file:0,rank:-1},{file:1,rank:1},{file:1,rank:-1},{file:-1,rank:1},{file:-1,rank:-1}],maxMove:1}},me={startingFen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",startingSide:r.WHITE,lightPlayerName:"Light",darkPlayerName:"Dark",lightTileColor:"#e0e0e0",darkTileColor:"#a1887f"};var A=(s=>(s[s.None=0]="None",s[s.ColumnsAndRows=1]="ColumnsAndRows",s[s.Every=2]="Every",s))(A||{});let W=me;function be(s){const e=s==null?{}:s;W={...W,...e}}function P(){return W}function Ee(){W=me}const K=class{constructor(e,t){f(this,"dom");f(this,"location");f(this,"piece",null);f(this,"highlight",m.None);this.dom=G(t.rank.valueOf()%2==(t.file.valueOf()%2==0?1:0)?"g-light-tile":"g-dark-tile"),this.dom.innerText=`${t.file==1?O[t.rank.valueOf()-1]:""}${t.rank==1?t.file:""}`,this.location=t,e.append(this.dom),K.fields.push(this)}IsFieldEmpty(){return this.piece==null}GetPiece(){return this.piece}SetPiece(e){this.piece=e}SetHightlight(e){switch(this.highlight=e,this.highlight){case m.PossibleMove:this.dom.className="highlighted possible";break;case m.Capture:this.dom.className="highlighted capturable";break;case m.Passant:this.dom.className="highlighted capturable";break;case m.Check:this.dom.className="highlighted incheck";break;case m.Origin:this.dom.className="highlighted origin";break;case m.Castling:this.dom.className="highlighted possible castling";break;default:this.dom.removeAttribute("class");break}}SetDisplayMode(e){switch(e){case A.ColumnsAndRows:this.dom.innerText=`${this.location.file==1?O[this.location.rank.valueOf()-1]:""}${this.location.rank==1?this.location.file:""}`;break;case A.Every:this.dom.innerText=`${O[this.location.rank.valueOf()-1]}${this.location.file}`;break;default:this.dom.innerText="";break}}UpdateFieldPosition(e){var t;this.location=e,this.SetDisplayMode(A.Every),(t=this.GetPiece())==null||t.SetPiecePosition(this.location)}static GetField(e){for(let t of K.fields)if(t.location.file==e.file&&t.location.rank==e.rank)return t;return null}static MassHighlightField(e){var t;for(let i of e)(t=this.GetField(i.location))==null||t.SetHightlight(i.moveType)}static MassRemoveHighlights(e){var t;for(let i of e)(t=this.GetField(i.location))==null||t.SetHightlight(m.None)}static DestroyFields(){this.fields=[]}};let a=K;f(a,"fields",[]);function G(s,e){const t=document.createElement(s);return e&&(t.className=e),t}function T(s,e){for(let t of e)if(t.location.file==s.file&&t.location.rank==s.rank)return!0;return!1}function M(s){return s==r.BLACK?r.WHITE:s==r.WHITE?r.BLACK:r.WHITE}function ce(s){var t;const e=[];for(let i=u;i>0;i--)for(let o=1;o<=u;o++)!((t=a.GetField({file:i,rank:o}))!=null&&t.IsFieldEmpty())&&a.GetField({file:i,rank:o}).GetPiece().color==s&&e.push(a.GetField({file:i,rank:o}).GetPiece());return e}function ye(s){var e;for(let t=u;t>0;t--)for(let i=1;i<=u;i++)if(!((e=a.GetField({file:t,rank:i}))!=null&&e.IsFieldEmpty())&&a.GetField({file:t,rank:i}).GetPiece().color==s&&a.GetField({file:t,rank:i}).GetPiece().type==h.KING)return{file:t,rank:i};return null}function de(s,e){for(let t=0;t<e.length;t++){const i=e[t];if(i.location.file==s.file&&i.location.rank==s.rank)return t}return-1}class L{constructor(e){f(this,"content","");f(this,"closeable",!1);f(this,"title");this.title=e}ShowModal(){const e=G("g-modal");document.body.append(e);const t=G("div","g-modal-background");e.append(t);const i=G("div","g-modal");i.innerHTML=`<div class="g-modal-title">${this.title}${this.closeable?"<div class='g-modal-close'>\u2716</div>":""}</div>`+this.content,e.append(i),this.closeable&&(document.getElementsByClassName("g-modal-close")[0].onclick=this.DestroyModal)}DestroyModal(){document.getElementsByTagName("g-modal")[0].remove()}Bind(...e){}}class ge extends L{constructor(){super("\xDAj j\xE1t\xE9k"),this.content=`
    <div style="margin: auto; text-align: center">
      <div class="g-newgame-setting">
        <span>Kezd\u0151 <a target="_blank" href="https://www.chess.com/terms/fen-chess">FEN</a>:</span>
        <input id="g-newgame-fen" type="text" placeholder="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR" />
      </div>
      <div class="g-newgame-setting">
        <span>Kezd\u0151 f\xE9l:</span>
        <select name="sides" id="g-newgame-side">
          <option value="light">Vil\xE1gos</option>
          <option value="dark">S\xF6t\xE9t</option>
        </select>
      </div>
      <div class="g-newgame-setting">
        <span>Vil\xE1gos j\xE1t\xE9kos neve:</span>
        <input id="g-newgame-lightname" type="text" value="Player1" />
      </div>
      <div class="g-newgame-setting">
        <span>S\xF6t\xE9t j\xE1t\xE9kos neve:</span>
        <input id="g-newgame-darkname" type="text" value="Player2" />
      </div>
      <div class="g-newgame-setting">
        <span>Vil\xE1gos mez\u0151 sz\xEDne:</span>
        <input id="g-newgame-lightcolor" type="color" value="#e0e0e0" />
      </div>
      <div class="g-newgame-setting">
        <span>S\xF6t\xE9t mez\u0151 sz\xEDne:</span>
        <input id="g-newgame-darkcolor" type="color" value="#a1887f" />
      </div>
      <div id="g-start-newgame" class="button">Kezd\xE9s</div>
    </div>
    `}Bind(){document.getElementById("g-start-newgame").onclick=this.StartGame}StartGame(){const e=document.getElementById("g-newgame-fen").value,t=document.getElementById("g-newgame-side").selectedIndex,i=document.getElementById("g-newgame-lightname").value,o=document.getElementById("g-newgame-darkname").value,n=document.getElementById("g-newgame-lightcolor").value,c=document.getElementById("g-newgame-darkcolor").value,l={};e.length>0&&(l.startingFen=e),t==0?l.startingSide=r.WHITE:l.startingSide=r.BLACK,i.length>0&&(l.lightPlayerName=i),o.length>0&&(l.darkPlayerName=o),n.length>0&&(l.lightTileColor=n),c.length>0&&(l.darkTileColor=c),document.getElementsByClassName("g-game")[0].innerHTML="",new he(document.getElementsByClassName("g-game")[0],l),super.DestroyModal()}}const Pe={w:"Feh\xE9r",b:"Fekete"};class fe extends L{constructor(e,t){super("A j\xE1t\xE9knak v\xE9ge");const i=t==!0?"Patt":Pe[e]+" sakk-mattot kapott!";this.content=`
    <div style="margin: auto; text-align: center">
      <div>${i}</div>
      <div id="g-end-button" style="margin-top: 10px" class="button">\xDAj j\xE1t\xE9k</div>
    </div>
    `}Bind(){document.getElementById("g-end-button").onclick=this.OnNewGameClick}OnNewGameClick(){super.DestroyModal();const e=new ge;e.ShowModal(),e.Bind()}}const xe=`
<div class="g-gamebar">
  <div class="g-gamebar-sidecontainer">
    <div class="g-gamebar-name" id="g-darkname">Duffka Erik Martin Ferenc J\xF3zsika Pista</div>
    <div class="g-gamebar-side g-gamebar-dark">
      <img src="assets/pieces/wp.png" alt="" />
      <div id="g-out-wp">0x</div>
      <img src="assets/pieces/wn.png" alt="" />
      <div id="g-out-wn">0x</div>
      <img src="assets/pieces/wb.png" alt="" />
      <div id="g-out-wb">0x</div>
      <img src="assets/pieces/wr.png" alt="" />
      <div id="g-out-wr">0x</div>
      <img src="assets/pieces/wq.png" alt="" />
      <div id="g-out-wq">0x</div>
    </div>
  </div>
  <div class="g-gamebar-sidecontainer">
    <div class="g-gamebar-side g-gamebar-light">
      <img src="assets/pieces/bp.png" alt="" />
      <div id="g-out-bp">0x</div>
      <img src="assets/pieces/bn.png" alt="" />
      <div id="g-out-bn">0x</div>
      <img src="assets/pieces/bb.png" alt="" />
      <div id="g-out-bb">0x</div>
      <img src="assets/pieces/br.png" alt="" />
      <div id="g-out-br">0x</div>
      <img src="assets/pieces/bq.png" alt="" />
      <div id="g-out-bq">0x</div>
    </div>
    <div class="g-gamebar-name" id="g-lightname">S\xE1ndor P\xE9ter</div>
  </div>
</div>
`;class w{constructor(e){const t=document.createElement("div");t.style.height="100%",t.innerHTML=xe,e.append(t)}static SetActiveSide(e){const t=e==r.WHITE?"g-gamebar-side g-gamebar-light":"g-gamebar-side g-gamebar-dark",i=e==r.WHITE?"g-gamebar-side g-gamebar-dark":"g-gamebar-side g-gamebar-light";document.getElementsByClassName(i)[0].className=`${i}`,document.getElementsByClassName(t)[0].className=`${t} g-active-side`}static AddKnockedPiece(e,t){var n;const i=((n=document.getElementById(`g-out-${e}${t}`))==null?void 0:n.innerText)||"0x",o=parseInt(i.replace("x",""))+1;document.getElementById(`g-out-${e}${t}`).innerText=`${o}x`}static SetPlayerName(e,t){const i=e==r.WHITE?"g-lightname":"g-darkname";document.getElementById(i).innerText=t}}class x{static NextTurn(){this.WhosTurn=M(this.WhosTurn),this.CheckEndGame(),w.SetActiveSide(this.WhosTurn)}static CheckEndGame(){let e=0;for(let t of ce(this.WhosTurn))t.RemovePassantable(),e+=this.GetValidMovesForPiece(t,!0,!1).length;if(e==0){let t;this.IsInCheck(this.WhosTurn)?t=new fe(this.WhosTurn,!1):t=new fe(this.WhosTurn,!0),t.ShowModal(),t.Bind()}}static GetValidMovesForPiece(e,t=!0,i){var p,F,_,N,S,C,v,E,B,$,R,z,V,q,U,j,X,Y,Q,J,Z,ee,te,ie,oe,se,ne,ae,le;const o=[];if(e.color!=this.WhosTurn&&!i)return[];const n=ke[e.type],c=n.moveDirections,l=e.active||n.firstMoveMax==null?n.maxMove:n.firstMoveMax;for(let d of c){const k=e.color==r.BLACK?-d.file:d.file,b=d.rank;let g=!1;for(let I=1;I<=l;I++){const y={file:e.location.file+I*k,rank:e.location.rank+I*b};let re=m.PossibleMove;if(g||y.file>8||y.rank>8||y.file<1||y.rank<1)break;if(!((p=a.GetField(y))!=null&&p.IsFieldEmpty())){if(((_=(F=a.GetField(y))==null?void 0:F.GetPiece())==null?void 0:_.color)==e.color)break;if(((S=(N=a.GetField(y))==null?void 0:N.GetPiece())==null?void 0:S.color)!=e.color&&n.specialAttack==null)g=!0,re=m.Capture;else break}if(t&&!this.IsMoveValid(e,y))break;const ue={location:y,moveType:re};o.push(ue)}}if(n.specialAttack!=null)for(let d of n.specialAttack){const k=e.color==r.BLACK?-d.file:d.file,b=d.rank,g={file:e.location.file+k,rank:e.location.rank+b};if(!((C=a.GetField(g))!=null&&C.IsFieldEmpty())&&((E=(v=a.GetField(g))==null?void 0:v.GetPiece())==null?void 0:E.color)!=e.color&&g.file<=8&&g.file>=1&&g.rank<=8&&g.rank>=1){if(t&&!this.IsMoveValid(e,g))break;const I={location:g,moveType:m.Capture};o.push(I)}}if(e.type==h.KING&&t){const d=e.color==r.WHITE?1:8,k=!this.IsInCheck(e.color)&&!e.active&&!((B=a.GetField({file:d,rank:8}))!=null&&B.IsFieldEmpty())&&((R=($=a.GetField({file:d,rank:8}))==null?void 0:$.GetPiece())==null?void 0:R.color)==e.color&&((V=(z=a.GetField({file:d,rank:8}))==null?void 0:z.GetPiece())==null?void 0:V.type)==h.ROOK&&!((U=(q=a.GetField({file:d,rank:8}))==null?void 0:q.GetPiece())!=null&&U.active)&&((j=a.GetField({file:d,rank:7}))==null?void 0:j.IsFieldEmpty())&&((X=a.GetField({file:d,rank:6}))==null?void 0:X.IsFieldEmpty())&&T({file:d,rank:6},o),b=!this.IsInCheck(e.color)&&!e.active&&!((Y=a.GetField({file:d,rank:1}))!=null&&Y.IsFieldEmpty())&&((J=(Q=a.GetField({file:d,rank:1}))==null?void 0:Q.GetPiece())==null?void 0:J.color)==e.color&&((ee=(Z=a.GetField({file:d,rank:1}))==null?void 0:Z.GetPiece())==null?void 0:ee.type)==h.ROOK&&!((ie=(te=a.GetField({file:d,rank:1}))==null?void 0:te.GetPiece())!=null&&ie.active)&&((oe=a.GetField({file:d,rank:2}))==null?void 0:oe.IsFieldEmpty())&&((se=a.GetField({file:d,rank:3}))==null?void 0:se.IsFieldEmpty())&&((ne=a.GetField({file:d,rank:4}))==null?void 0:ne.IsFieldEmpty())&&T({file:d,rank:4},o);if(k){const g={location:{file:d,rank:7},moveType:m.Castling};o.push(g)}if(b){const g={location:{file:d,rank:3},moveType:m.Castling};o.push(g)}}if(e.type==h.PAWN&&t){const d=e.color==r.BLACK?-1:1,k=(ae=a.GetField({file:e.location.file,rank:e.location.rank.valueOf()-1}))==null?void 0:ae.GetPiece(),b=(le=a.GetField({file:e.location.file,rank:e.location.rank.valueOf()+1}))==null?void 0:le.GetPiece();if(k&&k.passantable&&(k==null?void 0:k.type)==h.PAWN){const g={location:{file:e.location.file.valueOf()+d,rank:e.location.rank.valueOf()-1},moveType:m.Passant};o.push(g)}if(b&&b.passantable&&(b==null?void 0:b.type)==h.PAWN){const g={location:{file:e.location.file.valueOf()+d,rank:e.location.rank.valueOf()+1},moveType:m.Passant};o.push(g)}}return o}static IsMoveValid(e,t){var n,c,l,p;const i=a.GetField(t).GetPiece();let o=!0;return(n=a.GetField(e.location))==null||n.SetPiece(null),(c=a.GetField(t))==null||c.SetPiece(e),this.IsInCheck(e.color)&&(o=!1),(l=a.GetField(e.location))==null||l.SetPiece(e),(p=a.GetField(t))==null||p.SetPiece(i),o}static IsInCheck(e){const t=ce(M(e));for(let i of t){const o=this.GetValidMovesForPiece(i,!1,!0);if(T(ye(e),o))return!0}return!1}}f(x,"WhosTurn");class Ge extends L{constructor(){super("El\u0151l\xE9ptet\xE9s"),this.content=`
    <div style="display: flex; flex-direction: row; gap: 5px">
        <div id="g-promotion-q" class="g-promotion-button">
            <img src="assets/pieces/wq.png" />
        </div>
        <div id="g-promotion-r" class="g-promotion-button">
            <img src="assets/pieces/wr.png" />
        </div>
        <div id="g-promotion-b" class="g-promotion-button">
            <img src="assets/pieces/wb.png" />
        </div>
        <div id="g-promotion-n" class="g-promotion-button">
            <img src="assets/pieces/wn.png" />
        </div>
    </div>
    `}Bind(e){document.getElementById("g-promotion-q").onclick=()=>{super.DestroyModal(),e(h.QUEEN)},document.getElementById("g-promotion-r").onclick=()=>{super.DestroyModal(),e(h.ROOK)},document.getElementById("g-promotion-b").onclick=()=>{super.DestroyModal(),e(h.BISHOP)},document.getElementById("g-promotion-n").onclick=()=>{super.DestroyModal(),e(h.KNIGHT)}}}class we{constructor(e,t,i,o){f(this,"_board");f(this,"_dom");f(this,"_color");f(this,"_type");f(this,"_location");f(this,"_moving",!1);f(this,"_possibleMoves",[]);f(this,"_active",!1);f(this,"_passantable",!1);f(this,"touchX",0);f(this,"touchY",0);this._board=e,this._location=t,this._color=i,this._type=o,this._dom=G("g-piece",`${this._color}${this._type}`),this.UpdatePiecePosition(),this._dom.onmousedown=n=>{this.StartDrag(n)},this._dom.onmouseup=n=>{this.StopDrag(n)},this._dom.onmousemove=n=>{this.WhileDrag(n)},this._dom.ontouchstart=n=>{this.StartDrag(n)},this._dom.ontouchend=n=>{this.StopDrag(n)},this._dom.ontouchmove=n=>{this.WhileDrag(n)},e.append(this._dom)}GetCaptured(){var e;(e=a.GetField(this._location))==null||e.SetPiece(null),this._dom.remove()}Activate(){this._active=!0}RemovePassantable(){this._passantable=!1}UpdatePiecePosition(){const e=(this._location.rank.valueOf()-1)*(this._board.offsetWidth/8),t=(8-this._location.file.valueOf())*(this._board.offsetHeight/8);this._dom.style.transform=`translate(${e}px, ${t}px)`}SetPiecePosition(e){this._location=e,this.UpdatePiecePosition()}MovePiece(e){var t,i,o,n,c;this.Activate(),(t=a.GetField(this.location))==null||t.SetPiece(null),this._location=e,(i=a.GetField(this._location))!=null&&i.IsFieldEmpty()||(w.AddKnockedPiece(M(this._color),a.GetField(this._location).GetPiece().type),(n=(o=a.GetField(this._location))==null?void 0:o.GetPiece())==null||n.GetCaptured()),(c=a.GetField(this._location))==null||c.SetPiece(this),new Audio("assets/move.mp3").play(),this.UpdatePiecePosition()}get color(){return this._color}get type(){return this._type}get location(){return this._location}get active(){return this._active}get passantable(){return this._passantable}StartDrag(e){var t;e.preventDefault(),this._moving=!0,this._dom.style.cursor="grabbing",this._dom.style.zIndex="10",this._possibleMoves=x.GetValidMovesForPiece(this,!0),(t=a.GetField(this.location))==null||t.SetHightlight(m.Origin),a.MassHighlightField(this._possibleMoves)}StopDrag(e){var p,F,_,N,S,C;e.preventDefault(),this._moving=!1,this._dom.style.cursor="",this._dom.style.zIndex="";const t=e.type=="mouseup"?e.x:this.touchX,i=e.type=="mouseup"?e.y:this.touchY;let o=this._board.getBoundingClientRect();const n=Math.floor((t-o.left)/(this._board.offsetWidth/8))+1,l={file:8-Math.floor((i-o.top)/(this._board.offsetHeight/8)),rank:n};if((p=a.GetField(this.location))==null||p.SetHightlight(m.None),T(l,this._possibleMoves)){if(!this.active&&!this.passantable&&Math.abs(this.location.file.valueOf()-l.file.valueOf())==2?this._passantable=!0:this.active&&this.passantable&&(this._passantable=!1),this.type==h.KING&&this._possibleMoves[de(l,this._possibleMoves)].moveType==m.Castling&&this._location.file==(this.color==r.WHITE?1:8)){const v=this.color==r.WHITE?1:8;l.rank==7?(_=(F=a.GetField({file:v,rank:8}))==null?void 0:F.GetPiece())==null||_.MovePiece({file:v,rank:6}):(S=(N=a.GetField({file:v,rank:1}))==null?void 0:N.GetPiece())==null||S.MovePiece({file:v,rank:4})}else if(this.type==h.PAWN){const v=this.color==r.WHITE?8:1;if(l.file==v){const E=new Ge;E.ShowModal(),E.Bind(B=>{this._type=B,this._dom.className=this._dom.className.replace("p",B)})}}if(this._possibleMoves[de(l,this._possibleMoves)].moveType==m.Passant){const v=this.color==r.BLACK?1:-1,E=(C=a.GetField({file:l.file.valueOf()+v,rank:l.rank}))==null?void 0:C.GetPiece();w.AddKnockedPiece(M(this._color),E.type),E.GetCaptured()}this.MovePiece(l),x.NextTurn()}a.MassRemoveHighlights(this._possibleMoves),this._possibleMoves=[],this.UpdatePiecePosition()}WhileDrag(e){if(e.preventDefault(),!this._moving)return;const t=e.type=="mousemove"?e.x:e.touches[0].clientX,i=e.type=="mousemove"?e.y:e.touches[0].clientY;e.type=="touchmove"&&(this.touchX=t,this.touchY=i);let o=this._board.getBoundingClientRect();const n=t-this._dom.offsetWidth/2-o.left,c=i-this._dom.offsetWidth/2-o.top;this._dom.style.transform=`translate(${n}px, ${c}px)`}}class Ie{static GetPiecesFromFEN(e){const t=[],i=e.split("/");for(let o=0;o<i.length;o++){const n=i[o].split("");let c=0;for(let l=0;l<n.length;l++){let p=parseInt(n[l]);if(!isNaN(p)){c+=p;continue}t.push({location:{file:8-o,rank:c+1},color:n[l].toLowerCase()==n[l]?r.BLACK:r.WHITE,type:h[Object.keys(h)[Object.values(h).indexOf(n[l].toLowerCase())]]}),c++}}return t}static NotateMove(e,t,i,o,n=!1,c=0){let l="";l+=t==h.PAWN?n?O[i.rank.valueOf()-1]:"":t.toUpperCase(),n&&(l+="x"),l+=`${O[o.rank.valueOf()-1]}${o.file}`,c>0&&(l="0-0",c>1&&(l+="-0")),x.IsInCheck(M(e))&&(l+="+"),console.log(l)}}const H=class{constructor(e){f(this,"boardElement");f(this,"gridElement");f(this,"shownSide");var t;H.Instance=this,this.boardElement=G("g-board"),this.gridElement=G("g-fields"),this.boardElement.append(this.gridElement),e.append(this.boardElement);for(let i=u;i>0;i--)for(let o=1;o<=u;o++)new a(this.gridElement,{file:i,rank:o});this.shownSide=r.WHITE;for(let i of Ie.GetPiecesFromFEN(P().startingFen)){let o=new we(this.boardElement,{file:i.location.file,rank:i.location.rank},i.color,i.type);(t=a.GetField({file:i.location.file,rank:i.location.rank}))==null||t.SetPiece(o)}window.onresize=()=>{var i,o;for(let n=u;n>0;n--)for(let c=1;c<=u;c++)(o=(i=a.GetField({file:n,rank:c}))==null?void 0:i.GetPiece())==null||o.UpdatePiecePosition()}}FlipBoardToSide(e){var t;if(e==r.WHITE&&this.shownSide!=r.WHITE||e==r.BLACK&&this.shownSide!=r.BLACK){for(let i=1;i<=u;i++)for(let o=1;o<=u;o++)(t=a.GetField({file:i,rank:o}))==null||t.UpdateFieldPosition({file:1+(8-i),rank:1+(8-o)});this.shownSide=e}}static SetFieldDisplayMode(e){var t;for(let i=u;i>0;i--)for(let o=1;o<=u;o++)(t=a.GetField({file:i,rank:o}))==null||t.SetDisplayMode(e)}};let D=H;f(D,"Instance");class he{constructor(e,t){f(this,"_boardContainerDOM");Ee(),be(t),e.className="g-game",document.documentElement.style.setProperty("--dark-tile-color",P().darkTileColor),document.documentElement.style.setProperty("--light-tile-color",P().lightTileColor),a.DestroyFields(),this._boardContainerDOM=G("div","g-board-container"),this._boardContainerDOM.style.width=e.style.height,this._boardContainerDOM.style.height=e.style.height,e.append(this._boardContainerDOM),new D(this._boardContainerDOM),new w(e),w.SetActiveSide(P().startingSide),w.SetPlayerName(r.WHITE,P().lightPlayerName),w.SetPlayerName(r.BLACK,P().darkPlayerName),x.WhosTurn=M(P().startingSide),x.CheckEndGame(),x.WhosTurn=P().startingSide,x.CheckEndGame(),x.WhosTurn=P().startingSide}}class Me extends L{constructor(){super("Be\xE1ll\xEDt\xE1sok"),super.closeable=!0,this.content=`
    <div style="display: flex; flex-direction: column; gap: 5px">
      <div class="g-newgame-setting">
        <span>Mez\u0151 koordin\xE1ta mutat\xE1sa:</span>
        <select id="settings-field-display">
          <option value="none">Sehol</option>
          <option selected value="colandrow">Csak sorok \xE9s oszlopok elej\xE9n</option>
          <option value="every">Minden mez\u0151n</option>
        </select>
        <span>Alul l\xE9v\u0151 oldal:</span>
        <select id="settings-field-display">
          <option value="light">Vil\xE1gos</option>
          <option value="dark">S\xF6t\xE9t</option>
          <option selected value="auto">Automatikus</option>
        </select>
      </div>
    </div>
    `}Bind(){document.getElementById("settings-field-display").onchange=this.ChangeDisplayMode}ChangeDisplayMode(){D.SetFieldDisplayMode(document.getElementById("settings-field-display").selectedIndex)}}new he(document.getElementById("game"));document.getElementById("newgame").onclick=()=>{const s=new ge;s.ShowModal(),s.Bind()};document.getElementById("settings").onclick=()=>{const s=new Me;s.ShowModal(),s.Bind()};
